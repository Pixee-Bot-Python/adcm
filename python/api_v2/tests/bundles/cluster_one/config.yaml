---
- type: cluster
  name: cluster_one
  version: &version '1.0'
  edition: community
  config_group_customization: true
  license: EULA.txt
  allow_maintenance_mode: true
  config: &config
    - name: string
      type: string
      required: false
      default: string
    - name: map_not_required
      type: map
      required: False
    - name: list
      type: list
      required: false
      default:
        - value1
        - value2
        - value3
    - name: boolean
      type: boolean
      required: false
      default: true
    - name: group
      type: group
      subs:
        - name: float
          type: float
          required: false
          default: 0.1
        - name: map
          type: map
          required: false
          default:
            integer_key: '10'
            string_key: string
        - name: text
          type: text
          required: false
          default: text
    - name: activatable_group
      type: group
      activatable: True
      active: True
      subs:
        - name: integer
          type: integer
          required: false
          default: 10
        - name: json
          type: json
          required: false
          default:
            key: value
        - name: structure
          type: structure
          required: false
          yspec: ./schema.yaml
          default:
            - integer: 1
              string: string1
            - integer: 2
              string: string2

  actions:
    action: &action
      type: job
      script: ./playbook.yaml
      script_type: ansible
      states:
        available: any

    with_config:
      <<: *action
      config:
        - name: simple
          type: string
          required: false
        - name: grouped
          type: group
          subs:
            - name: simple
              type: integer
              default: 4
            - name: second
              type: float
              default: 4.3
        - name: after
          type: list
          default:
            - "1"
            - "woohoo"

    with_hc:
      <<: *action
      hc_acl:
        - action: add
          service: service_1
          component: component_1
        - action: remove
          service: service_1
          component: component_2

    cluster_on_host: &host_action
      <<: *action
      host_action: true

  export:
    - string

- name: service_1
  type: service
  version: *version
  config: *config
  license: EULA.txt
  actions:
    action: *action
    service_on_host: *host_action

  components:
    component_1:
      constraint: [ 0, + ]
      config: *config
      actions:
        action_1_comp_1: *action
        action_2_comp_1: *action
        component_on_host: *host_action
    component_2:
      constraint: [ 0, + ]
      config: *config
      actions:
        action_1_comp_2: *action

- name: service_2
  type: service
  version: *version
  config: *config
  actions:
    action_1_service_2: *action
    action_2_service_2: *action

- name: service_3_manual_add
  type: service
  version: *version
  config: *config
