---

version: 1

roles:
    - name: base
      description: Base user role
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: user
              codenames:
                - view
                - self_change_password

    - name: create Host
      description: The ability to add new host
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - add

    - name: create HostProvider
      description: The ability to add new provider
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: hostprovider
              codenames:
                - add

    - name: create Cluster
      description: The ability to add new cluster
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: cluster
              codenames:
                - add

    - name: upload Bundle
      description: The ability to upload Bundle
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: bundle
              codenames:
                - add

    - name: Compare cluster configurations
      description: The ability to view the history of cluster configuration page
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Compare service configurations
      description: The ability to view the history of service configuration page
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Compare component configurations
      description: The ability to view the history of component configuration page
      parametrized_by:
        - component
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ServiceComponent
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Compare provider configurations
      description: The ability to view the history of provider configuration page
      parametrized_by:
        - provider
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: HostProvider
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Compare host configurations
      description: The ability to view the history of host configuration page
      parametrized_by:
        - host
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Host
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Compare configurations
      description: The ability to see the history of all configuration
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - Compare cluster configurations
        - Compare service configurations
        - Compare component configurations
        - Compare provider configurations
        - Compare host configurations

    - name: View cluster configurations
      description: The ability to view the cluster configuration page
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: View service configurations
      description: The ability to view the service configuration page
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: View component configurations
      description: The ability to view the component configuration page
      parametrized_by:
        - component
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ServiceComponent
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: View provider configurations
      description: The ability to view the provider configuration page
      parametrized_by:
        - provider
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: HostProvider
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: View host configurations
      description: The ability to view the host configuration page
      parametrized_by:
        - host
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Host
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: View configurations
      description: The ability to view all configurations
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - View cluster configurations
        - View service configurations
        - View component configurations
        - View provider configurations
        - View host configurations

    - name: Edit cluster configurations
      description: The ability to change and add new cluster configuration
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: Edit service configurations
      description: The ability to change and add new service configuration
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: Edit component configurations
      description: The ability to change and add new component configuration
      parametrized_by:
        - component
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ServiceComponent
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: Edit provider configurations
      description: The ability to change and add new provider configuration
      parametrized_by:
        - provider
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: HostProvider
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: Edit host configurations
      description: The ability to change and add new host configuration
      parametrized_by:
        - host
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Host
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: Edit configurations
      description: The ability to edit all configurations
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - Edit cluster configurations
        - Edit service configurations
        - Edit component configurations
        - Edit provider configurations
        - Edit host configurations

    - name: View cluster imports
      description: The ability to view the cluster import page
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: clusterbind
              codenames:
                - view

    - name: View service imports
      description: The ability to view the service import page
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: clusterbind
              codenames:
                - view

    - name: View imports
      description: The ability to view all imports page on cluster and service
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - View cluster imports
        - View service imports

    - name: Manage cluster imports
      description: The ability to change cluster imports
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: clusterbind
              codenames:
                - add
                - change

    - name: Manage service imports
      description: The ability to change service imports
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: clusterbind
              codenames:
                - add
                - change

    - name: Manage imports
      description: The ability to manage all imports page on cluster and service
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - Manage cluster imports
        - Manage service imports

    - name: Add service
      description: The ability to add service to cluster
      business_permit: True
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: clusterobject
              codenames:
                - add

    - name: Remove service
      description: The ability to remove service from cluster
      business_permit: True
      parametrized_by:
        - service
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ClusterObject
      apps:
        - label: cm
          models:
            - name: clusterobject
              codenames:
                - delete

    - name: Remove host
      description: The ability to remove host
      business_permit: True
      parametrized_by:
        - host
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Host
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - delete

    - name: Map hosts
      description: The ability to map hosts to the Cluster
      business_permit: True
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - change
            - name: cluster
              codenames:
                - change

    - name: Unmap hosts
      description: The ability to unmap hosts to the Cluster
      business_permit: True
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - change
            - name: cluster
              codenames:
                - change

    - name: Upgrade cluster bundle
      description: Update the cluster bundle
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: upgrade
              codenames:
                - add

    - name: Upgrade provider bundle
      description: Update the provider bundle
      parametrized_by:
        - provider
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: HostProvider
      apps:
        - label: cm
          models:
            - name: upgrade
              codenames:
                - add

    - name: Upgrade bundle
      description: Update all type of bundles
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - Upgrade cluster bundle
        - Upgrade provider bundle

    - name: Remove cluster
      description: The ability to remove cluster
      business_permit: True
      parametrized_by:
        - cluster
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: Cluster
      apps:
        - label: cm
          models:
            - name: cluster
              codenames:
                - delete

    - name: Remove provider
      description: The ability to remove provider
      business_permit: True
      parametrized_by:
        - provider
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: HostProvider
      apps:
        - label: cm
          models:
            - name: hostprovider
              codenames:
                - delete

    - name: Remove bundle
      description: The ability to remove bundle
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: bundle
              codenames:
                - delete

    - name: View ADCM settings
      description: View purely adcm config
      business_permit: True
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ADCM
        filter:
          name: ADCM
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view

    - name: Compare ADCM settings
      description: compare settings purely adcm config
      business_permit: True
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ADCM
        filter:
          name: ADCM
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - view
            - name: configlog
              codenames:
                - view

    - name: Edit ADCM settings
      description: Edit purely adcm config
      business_permit: True
      module_name: rbac.roles
      class_name: ObjectRole
      init_params:
        app_name: cm
        model: ADCM
        filter:
          name: ADCM
      apps:
        - label: cm
          models:
            - name: objectconfig
              codenames:
                - add
                - change
            - name: configlog
              codenames:
                - add
                - change

    - name: View users
      description: The ability to view Users page
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: user
              codenames:
                - view

    - name: Create user
      description: The ability to create new user
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: user
              codenames:
                - add

    - name: Edit user
      description: The ability to change information about existed user
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: user
              codenames:
                - change

    - name: Remove users
      description: The ability to delete existed user
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: user
              codenames:
                - delete

    - name: View roles
      description: The ability to view roles page
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: role
              codenames:
                - view

    - name: Create custom role
      description: The ability to create new role
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: role
              codenames:
                - add

    - name: Edit role
      description: The ability to change your custom role
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: role
              codenames:
                - change

    - name: Remove roles
      description: The ability to delete custom roles
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: role
              codenames:
                - delete

    - name: View group
      description: The ability to view group page
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: group
              codenames:
                - view

    - name: Create group
      description: The ability to create new group
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: group
              codenames:
                - add

    - name: Edit group
      description: The ability to change group
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: group
              codenames:
                - change

    - name: Remove group
      description: The ability to delete roles
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: auth
          models:
            - name: group
              codenames:
                - delete

    - name: View policy
      description: The ability to policy group page
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: policy
              codenames:
                - view

    - name: Create policy
      description: The ability to create new policy
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: policy
              codenames:
                - add

    - name: Edit policy
      description: The ability to change policies
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: policy
              codenames:
                - change

    - name: Remove policy
      description: The ability to delete policies
      business_permit: True
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: rbac
          models:
            - name: policy
              codenames:
                - delete

    - name: View cluster status page
      description: The ability to view status page of exact cluster
      module_name: rbac.roles
      class_name: ObjectRole
      parametrized_by:
        - cluster
      init_params:
        init_params:
          app_name: cm
          model: Cluster
      apps:
        - label: cm
          models:
            - name: cluster
              codenames:
                - status_view

    - name: View service status page
      description: The ability to view status page of exact service
      module_name: rbac.roles
      class_name: ObjectRole
      parametrized_by:
        - service
      init_params:
        init_params:
          app_name: cm
          model: ClusterObject
      apps:
        - label: cm
          models:
            - name: clusterobject
              codenames:
                - status_view

    - name: View component status page
      description: The ability to view status page of exact component
      module_name: rbac.roles
      class_name: ObjectRole
      parametrized_by:
        - component
      init_params:
        init_params:
          app_name: cm
          model: ServiceComponent
      apps:
        - label: cm
          models:
            - name: servicecomponent
              codenames:
                - status_view

    - name: View host status page
      description: The ability to view status page of exact host
      module_name: rbac.roles
      class_name: ObjectRole
      parametrized_by:
        - host
      init_params:
        init_params:
          app_name: cm
          model: Host
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - status_view

    - name: View status page
      description: Ability to view all status pages
      business_permit: True
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - View cluster status page
        - View service status page
        - View component status page
        - View host status page

    - name: Base role
      description: Default list of view permissions for all objects
      business_permit: False
      module_name: rbac.roles
      class_name: ParentRole
      child:
        - Get ADCM Object
        - Get Provider
        - Get Cluster
        - Get Host
        - Get Service
        - Get Component
        - Get Task and Jobs
        - Get stack
        - Get concerns

    - name: Get ADCM Object
      description: Read access to ADCM
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: adcm
              codenames:
                - view

    - name: Get Provider
      description: Read access to Provider
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: hostprovider
              codenames:
                - view

    - name: Get Cluster
      description: Read access to Clusters
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: cluster
              codenames:
                - view

    - name: Get Host
      description: Read access to Host
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: host
              codenames:
                - view

    - name: Get Service
      description: Read access to Service
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: clusterobject
              codenames:
                - view

    - name: Get Component
      description: Read access to Component
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: servicecomponent
              codenames:
                - view

    - name: Get Task and Jobs
      description: Read access to job execution information
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: tasklog
              codenames:
                - view
            - name: joblog
              codenames:
                - view
            - name: logstorage
              codenames:
                - view

    - name: Get stack
      description: Read access to all prototypes
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: prototype
              codenames:
                - view
            - name: bundle
              codenames:
                - view
            - name: action
              codenames:
                - view
            - name: prototypeconfig
              codenames:
                - view
            - name: prototypeexport
              codenames:
                - view
            - name: prototypeimport
              codenames:
                - view

    - name: Get concerns
      description: Read access to all concerns
      business_permit: False
      module_name: rbac.roles
      class_name: ModelRole
      apps:
        - label: cm
          models:
            - name: concernitem
              codenames:
                - view
            - name: bundle
              codenames:
                - view
            - name: action
              codenames:
                - view


