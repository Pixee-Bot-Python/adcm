---

- type: cluster
  name: multi_state
  version: 1

  actions:
    state_changing_fail:
      type: task
      allow_to_terminate: true
      scripts:
        - script_type: ansible
          script: fail.yaml
          name: "first_step"
        - script_type: ansible
          script: ok.yaml
          name: "second_step"
      masking:
      on_fail:
        state: multi_fail
        multi_state:
          set:
            - "multi_fail"
      on_success:
        state: multi_ok
        multi_state:
          set:
            - "multi_ok"
